
        <!DOCTYPE html>
        <html>
        <head>
            <title>Molecule Shape Comparison</title>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
            <script src="https://3dmol.csb.pitt.edu/build/3Dmol-min.js"></script>
            <style>
                body {
                    font-family: Arial, sans-serif;
                    margin: 20px;
                }
                .container {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                }
                .viewers-container {
                    display: flex;
                    justify-content: space-between;
                    width: 100%;
                    max-width: 1200px;
                }
                .viewer-box {
                    width: 48%;
                }
                .viewer {
                    width: 100%;
                    height: 400px;
                    position: relative;
                    margin: 10px 0;
                }
                .info {
                    width: 100%;
                    max-width: 1200px;
                    background-color: #f5f5f5;
                    padding: 15px;
                    border-radius: 5px;
                    margin-bottom: 20px;
                }
                .molecule-name {
                    text-align: center;
                    font-weight: bold;
                    margin-bottom: 5px;
                }
                h2 {
                    color: #333;
                }
                .controls {
                    display: flex;
                    justify-content: center;
                    gap: 10px;
                    margin-bottom: 20px;
                }
                button {
                    padding: 8px 15px;
                    background-color: #4CAF50;
                    color: white;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                }
                button:hover {
                    background-color: #45a049;
                }
                .metrics {
                    width: 100%;
                    max-width: 1200px;
                    margin-top: 20px;
                    padding: 15px;
                    background-color: #e9f7ef;
                    border-radius: 5px;
                }
                .metrics h3 {
                    margin-top: 0;
                }
                table {
                    width: 100%;
                    border-collapse: collapse;
                }
                th, td {
                    padding: 8px;
                    text-align: left;
                    border-bottom: 1px solid #ddd;
                }
                th {
                    background-color: #f2f2f2;
                }
            </style>
        </head>
        <body>
            <div class="container">
                <h2>Molecule Shape Comparison</h2>
                
                <div class="info">
                    <p>This visualization shows the 3D shapes of two molecules side by side.</p>
                    <p>Use the mouse to rotate and zoom. The controls below each viewer allow you to toggle different visualization elements.</p>
                </div>
                
                <div class="viewers-container">
                    <div class="viewer-box">
                        <div class="molecule-name">Molecule 1: [H]OC(=O)c1c([H])c([H])c([H])c([H])c1OC(=O)C([H])([H])[H]</div>
                        <div id="viewer1" class="viewer"></div>
                        <div class="controls">
                            <button onclick="toggleSurface(1)">Toggle Surface</button>
                            <button onclick="toggleSticks(1)">Toggle Sticks</button>
                            <button onclick="resetView(1)">Reset View</button>
                        </div>
                    </div>
                    
                    <div class="viewer-box">
                        <div class="molecule-name">Molecule 2: [H]OC(=O)C([H])(c1c([H])c([H])c(C([H])([H])C([H])(C([H])([H])[H])C([H])([H])[H])c([H])c1[H])C([H])([H])[H]</div>
                        <div id="viewer2" class="viewer"></div>
                        <div class="controls">
                            <button onclick="toggleSurface(2)">Toggle Surface</button>
                            <button onclick="toggleSticks(2)">Toggle Sticks</button>
                            <button onclick="resetView(2)">Reset View</button>
                        </div>
                    </div>
                </div>
                
                <div class="metrics">
                    <h3>Shape Similarity Metrics</h3>
                    <table>
                        <tr>
                            <th>Metric</th>
                            <th>Value</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>USR Similarity</td>
                            <td id="usr-sim">Calculating...</td>
                            <td>Ultrafast Shape Recognition similarity (0-1 scale)</td>
                        </tr>
                        <tr>
                            <td>USRCAT Similarity</td>
                            <td id="usrcat-sim">Calculating...</td>
                            <td>USR with Chemical Atom Types (0-1 scale)</td>
                        </tr>
                        <tr>
                            <td>NPR Distance</td>
                            <td id="npr-dist">Calculating...</td>
                            <td>Normalized PMI Ratio distance (lower is more similar)</td>
                        </tr>
                        <tr>
                            <td>Gaussian Shape Overlap</td>
                            <td id="gso-overlap">Calculating...</td>
                            <td>Tanimoto coefficient of Gaussian shape functions (0-1 scale)</td>
                        </tr>
                    </table>
                </div>
            </div>
            
            <script>
                let viewer1 = null;
                let viewer2 = null;
                let surfaceOn1 = true;
                let surfaceOn2 = true;
                let sticksOn1 = true;
                let sticksOn2 = true;
                
                $(document).ready(function() {
                    // Initialize first viewer
                    viewer1 = $3Dmol.createViewer($("#viewer1"), {backgroundColor: 'white'});
                    let m1 = viewer1.addModel(`HETATM    1  C1  UNL     1      -3.003   0.675  -1.288  1.00  0.00           C  
HETATM    2  C2  UNL     1      -1.725  -0.045  -0.979  1.00  0.00           C  
HETATM    3  O1  UNL     1      -1.322  -1.029  -1.586  1.00  0.00           O  
HETATM    4  O2  UNL     1      -1.107   0.582   0.097  1.00  0.00           O  
HETATM    5  C3  UNL     1       0.120  -0.000   0.424  1.00  0.00           C  
HETATM    6  C4  UNL     1       0.108  -0.904   1.494  1.00  0.00           C  
HETATM    7  C5  UNL     1       1.293  -1.516   1.900  1.00  0.00           C  
HETATM    8  C6  UNL     1       2.487  -1.219   1.247  1.00  0.00           C  
HETATM    9  C7  UNL     1       2.499  -0.301   0.192  1.00  0.00           C  
HETATM   10  C8  UNL     1       1.316   0.329  -0.228  1.00  0.00           C  
HETATM   11  C9  UNL     1       1.442   1.307  -1.337  1.00  0.00           C  
HETATM   12  O3  UNL     1       2.461   1.518  -1.973  1.00  0.00           O  
HETATM   13  O4  UNL     1       0.329   2.014  -1.597  1.00  0.00           O  
HETATM   14  H1  UNL     1      -3.683   0.606  -0.434  1.00  0.00           H  
HETATM   15  H2  UNL     1      -3.481   0.209  -2.154  1.00  0.00           H  
HETATM   16  H3  UNL     1      -2.793   1.720  -1.529  1.00  0.00           H  
HETATM   17  H4  UNL     1      -0.823  -1.138   2.003  1.00  0.00           H  
HETATM   18  H5  UNL     1       1.285  -2.227   2.722  1.00  0.00           H  
HETATM   19  H6  UNL     1       3.412  -1.698   1.558  1.00  0.00           H  
HETATM   20  H7  UNL     1       3.444  -0.077  -0.302  1.00  0.00           H  
HETATM   21  H8  UNL     1       0.605   2.603  -2.330  1.00  0.00           H  
CONECT    1    2   14   15   16
CONECT    2    3    3    4
CONECT    4    5
CONECT    5    6    6   10
CONECT    6    7   17
CONECT    7    8    8   18
CONECT    8    9   19
CONECT    9   10   10   20
CONECT   10   11
CONECT   11   12   12   13
CONECT   13   21
END
`, "pdb");
                    viewer1.setStyle({}, {stick: {radius: 0.2, color: 'skyBlue'}, 
                                          sphere: {scale: 0.3, color: 'skyBlue'}});
                    viewer1.addSurface($3Dmol.VDW, {opacity: 0.6, color: 'skyBlue'});
                    viewer1.zoomTo();
                    viewer1.render();
                    
                    // Initialize second viewer
                    viewer2 = $3Dmol.createViewer($("#viewer2"), {backgroundColor: 'white'});
                    let m2 = viewer2.addModel(`HETATM    1  C1  UNL     1       1.451  -4.479   0.335  1.00  0.00           C  
HETATM    2  C2  UNL     1      -0.005  -4.540  -0.130  1.00  0.00           C  
HETATM    3  C3  UNL     1      -0.952  -4.478   1.068  1.00  0.00           C  
HETATM    4  C4  UNL     1      -0.334  -3.490  -1.211  1.00  0.00           C  
HETATM    5  C5  UNL     1      -0.208  -2.042  -0.798  1.00  0.00           C  
HETATM    6  C6  UNL     1      -1.302  -1.357  -0.256  1.00  0.00           C  
HETATM    7  C7  UNL     1      -1.185  -0.018   0.126  1.00  0.00           C  
HETATM    8  C8  UNL     1       0.029   0.667  -0.023  1.00  0.00           C  
HETATM    9  C9  UNL     1       1.119  -0.018  -0.577  1.00  0.00           C  
HETATM   10  C10 UNL     1       1.001  -1.357  -0.959  1.00  0.00           C  
HETATM   11  C11 UNL     1       0.174   2.123   0.381  1.00  0.00           C  
HETATM   12  C12 UNL     1      -0.164   2.361   1.855  1.00  0.00           C  
HETATM   13  C13 UNL     1      -0.600   3.041  -0.547  1.00  0.00           C  
HETATM   14  O1  UNL     1      -0.186   3.508  -1.598  1.00  0.00           O  
HETATM   15  O2  UNL     1      -1.864   3.299  -0.154  1.00  0.00           O  
HETATM   16  H1  UNL     1       1.681  -5.330   0.986  1.00  0.00           H  
HETATM   17  H2  UNL     1       2.136  -4.519  -0.518  1.00  0.00           H  
HETATM   18  H3  UNL     1       1.659  -3.566   0.903  1.00  0.00           H  
HETATM   19  H4  UNL     1      -0.148  -5.523  -0.601  1.00  0.00           H  
HETATM   20  H5  UNL     1      -0.781  -5.329   1.736  1.00  0.00           H  
HETATM   21  H6  UNL     1      -0.808  -3.566   1.655  1.00  0.00           H  
HETATM   22  H7  UNL     1      -1.997  -4.518   0.743  1.00  0.00           H  
HETATM   23  H8  UNL     1       0.310  -3.661  -2.085  1.00  0.00           H  
HETATM   24  H9  UNL     1      -1.356  -3.661  -1.577  1.00  0.00           H  
HETATM   25  H10 UNL     1      -2.257  -1.862  -0.129  1.00  0.00           H  
HETATM   26  H11 UNL     1      -2.058   0.485   0.538  1.00  0.00           H  
HETATM   27  H12 UNL     1       2.073   0.485  -0.720  1.00  0.00           H  
HETATM   28  H13 UNL     1       1.865  -1.862  -1.387  1.00  0.00           H  
HETATM   29  H14 UNL     1       1.226   2.420   0.268  1.00  0.00           H  
HETATM   30  H15 UNL     1      -0.014   3.414   2.119  1.00  0.00           H  
HETATM   31  H16 UNL     1       0.477   1.754   2.504  1.00  0.00           H  
HETATM   32  H17 UNL     1      -1.204   2.113   2.092  1.00  0.00           H  
HETATM   33  H18 UNL     1      -2.222   3.852  -0.880  1.00  0.00           H  
CONECT    1    2   16   17   18
CONECT    2    3    4   19
CONECT    3   20   21   22
CONECT    4    5   23   24
CONECT    5    6    6   10
CONECT    6    7   25
CONECT    7    8    8   26
CONECT    8    9   11
CONECT    9   10   10   27
CONECT   10   28
CONECT   11   12   13   29
CONECT   12   30   31   32
CONECT   13   14   14   15
CONECT   15   33
END
`, "pdb");
                    viewer2.setStyle({}, {stick: {radius: 0.2, color: 'lightGreen'}, 
                                          sphere: {scale: 0.3, color: 'lightGreen'}});
                    viewer2.addSurface($3Dmol.VDW, {opacity: 0.6, color: 'lightGreen'});
                    viewer2.zoomTo();
                    viewer2.render();
                    
                    // Update metrics
                    updateMetrics();
                });
                
                function toggleSurface(viewerNum) {
                    let viewer = viewerNum === 1 ? viewer1 : viewer2;
                    let surfaceOn = viewerNum === 1 ? surfaceOn1 : surfaceOn2;
                    let color = viewerNum === 1 ? 'skyBlue' : 'lightGreen';
                    
                    surfaceOn = !surfaceOn;
                    if (viewerNum === 1) surfaceOn1 = surfaceOn;
                    else surfaceOn2 = surfaceOn;
                    
                    viewer.removeAllSurfaces();
                    
                    if (surfaceOn) {
                        viewer.addSurface($3Dmol.VDW, {opacity: 0.6, color: color});
                    }
                    
                    viewer.render();
                }
                
                function toggleSticks(viewerNum) {
                    let viewer = viewerNum === 1 ? viewer1 : viewer2;
                    let sticksOn = viewerNum === 1 ? sticksOn1 : sticksOn2;
                    let color = viewerNum === 1 ? 'skyBlue' : 'lightGreen';
                    
                    sticksOn = !sticksOn;
                    if (viewerNum === 1) sticksOn1 = sticksOn;
                    else sticksOn2 = sticksOn;
                    
                    if (sticksOn) {
                        viewer.setStyle({}, {stick: {radius: 0.2, color: color}, 
                                            sphere: {scale: 0.3, color: color}});
                    } else {
                        viewer.setStyle({}, {sphere: {scale: 0.3, color: color}});
                    }
                    
                    viewer.render();
                }
                
                function resetView(viewerNum) {
                    let viewer = viewerNum === 1 ? viewer1 : viewer2;
                    viewer.zoomTo();
                    viewer.render();
                }
                
                function updateMetrics() {
                    // In a real application, you would calculate these values in Python
                    // and pass them to the HTML. For this example, we'll use placeholders.
                    setTimeout(function() {
                        document.getElementById('usr-sim').textContent = 'PLACEHOLDER';
                        document.getElementById('usrcat-sim').textContent = 'PLACEHOLDER';
                        document.getElementById('npr-dist').textContent = 'PLACEHOLDER';
                        document.getElementById('gso-overlap').textContent = 'PLACEHOLDER';
                    }, 1000);
                }
            </script>
        </body>
        </html>
        